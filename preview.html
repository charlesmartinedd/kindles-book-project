<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Know Your Homebook - Page Preview</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Source+Sans+3:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --lake-teal: #3A9C8E;
            --lake-teal-dark: #2d7a6f;
            --campfire-coral: #E94A70;
            --sunrise-orange: #F7941E;
            --granite: #424242;
            --mist: #FAF6F0;
            --white: #ffffff;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Source Sans 3', sans-serif;
            background: var(--mist);
            color: var(--granite);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
        }

        h1, h2, h3, .section-title, .btn {
            font-family: 'Montserrat', sans-serif;
        }

        /* Main Layout */
        .app {
            display: grid;
            grid-template-rows: auto 1fr auto;
            height: 100vh;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--lake-teal) 0%, var(--lake-teal-dark) 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header-logo {
            font-size: 1.5rem;
        }

        .header-title {
            font-size: 1.1rem;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .header-subtitle {
            font-size: 0.75rem;
            opacity: 0.85;
            font-weight: 400;
        }

        .header-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .btn-outline {
            background: transparent;
            border: 1.5px solid rgba(255,255,255,0.5);
            color: white;
        }

        .btn-outline:hover {
            background: rgba(255,255,255,0.1);
            border-color: white;
        }

        .btn-coral {
            background: var(--campfire-coral);
            color: white;
        }

        .btn-coral:hover {
            background: #d43d62;
        }

        /* Main Content */
        .main {
            display: grid;
            grid-template-columns: 320px 1fr;
            overflow: hidden;
        }

        /* Sidebar TOC */
        .sidebar {
            background: white;
            border-right: 1px solid rgba(0,0,0,0.08);
            overflow-y: auto;
            padding: 1rem 0;
        }

        .sidebar-header {
            padding: 0 1rem 0.75rem;
            border-bottom: 1px solid rgba(0,0,0,0.06);
            margin-bottom: 0.5rem;
        }

        .sidebar-title {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--lake-teal);
        }

        .section {
            border-bottom: 1px solid rgba(0,0,0,0.04);
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.6rem 1rem;
            cursor: pointer;
            transition: background 0.15s ease;
        }

        .section-header:hover {
            background: rgba(58, 156, 142, 0.06);
        }

        .section.active .section-header {
            background: rgba(58, 156, 142, 0.1);
            border-left: 3px solid var(--lake-teal);
            padding-left: calc(1rem - 3px);
        }

        .section-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-icon {
            font-size: 1rem;
        }

        .section-name {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--granite);
        }

        .section-badge {
            background: var(--campfire-coral);
            color: white;
            font-size: 0.65rem;
            font-weight: 700;
            padding: 0.15rem 0.4rem;
            border-radius: 10px;
            min-width: 20px;
            text-align: center;
        }

        .section-chevron {
            font-size: 0.7rem;
            color: #999;
            transition: transform 0.2s ease;
        }

        .section.active .section-chevron {
            transform: rotate(180deg);
        }

        .section-pages {
            display: none;
            padding: 0.25rem 0 0.5rem;
        }

        .section.active .section-pages {
            display: block;
        }

        .page-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 1rem 0.4rem 2.25rem;
            cursor: pointer;
            transition: all 0.15s ease;
            font-size: 0.8rem;
            color: #666;
        }

        .page-item:hover {
            background: rgba(58, 156, 142, 0.06);
            color: var(--granite);
        }

        .page-item.active {
            background: rgba(58, 156, 142, 0.12);
            color: var(--lake-teal);
            font-weight: 600;
        }

        .page-num {
            font-size: 0.7rem;
            color: #999;
            min-width: 18px;
        }

        .page-item.active .page-num {
            color: var(--lake-teal);
        }

        /* Preview Panel */
        .preview-panel {
            background: var(--mist);
            display: flex;
            flex-direction: column;
            padding: 1rem;
            overflow: hidden;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .preview-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--granite);
        }

        .preview-nav {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid rgba(0,0,0,0.1);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            color: #666;
            transition: all 0.15s ease;
        }

        .nav-btn:hover {
            border-color: var(--lake-teal);
            color: var(--lake-teal);
        }

        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .page-counter {
            font-size: 0.75rem;
            color: #888;
            padding: 0 0.5rem;
        }

        .preview-container {
            flex: 1;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px var(--shadow);
            overflow: hidden;
            position: relative;
        }

        .preview-frame-wrapper {
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding: 1rem;
        }

        .preview-frame {
            width: 816px;
            height: 1056px;
            border: none;
            transform-origin: top center;
            transform: scale(0.55);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .preview-actions {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            margin-top: 0.75rem;
        }

        /* Footer */
        .footer {
            background: white;
            border-top: 1px solid rgba(0,0,0,0.08);
            padding: 0.5rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.75rem;
            color: #888;
        }

        .footer-brand {
            display: flex;
            align-items: center;
            gap: 0.35rem;
            color: var(--lake-teal);
            font-weight: 600;
        }

        /* Modal */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(66, 66, 66, 0.9);
            backdrop-filter: blur(8px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-backdrop.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }

        .modal-backdrop.active .modal-content {
            transform: scale(1);
        }

        .modal-frame-wrapper {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 25px 80px rgba(0,0,0,0.4);
        }

        .modal-frame {
            width: 816px;
            height: 1056px;
            border: none;
            display: block;
        }

        .modal-close {
            position: absolute;
            top: -40px;
            right: 0;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: white;
            color: var(--granite);
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: var(--campfire-coral);
            color: white;
        }

        .modal-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            background: white;
            color: var(--granite);
            font-size: 1.4rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .modal-nav:hover {
            background: var(--lake-teal);
            color: white;
        }

        .modal-nav:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .modal-prev {
            left: -60px;
        }

        .modal-next {
            right: -60px;
        }

        .modal-page-info {
            position: absolute;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 0.85rem;
            font-weight: 500;
        }

        /* Loading spinner */
        .loading {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--mist);
            border-top-color: var(--lake-teal);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-brand">
                <span class="header-logo">üè†</span>
                <div>
                    <div class="header-title">Know Your Homebook</div>
                    <div class="header-subtitle">Internal Preview - 40 Pages</div>
                </div>
            </div>
            <div class="header-actions">
                <a href="output/Know-Your-Homebook.pdf" target="_blank" class="btn btn-outline">View PDF</a>
                <a href="index.html" class="btn btn-coral">Landing Page</a>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main">
            <!-- Sidebar TOC -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">Table of Contents</div>
                </div>
                <div id="toc"></div>
            </aside>

            <!-- Preview Panel -->
            <div class="preview-panel">
                <div class="preview-header">
                    <div class="preview-title" id="previewTitle">Select a page to preview</div>
                    <div class="preview-nav">
                        <button class="nav-btn" id="prevBtn" onclick="navigatePage(-1)">&#8592;</button>
                        <span class="page-counter" id="pageCounter">0 / 40</span>
                        <button class="nav-btn" id="nextBtn" onclick="navigatePage(1)">&#8594;</button>
                    </div>
                </div>
                <div class="preview-container">
                    <div class="loading" id="previewLoading">
                        <div class="spinner"></div>
                    </div>
                    <div class="preview-frame-wrapper">
                        <iframe class="preview-frame" id="previewFrame" src="about:blank"></iframe>
                    </div>
                </div>
                <div class="preview-actions">
                    <button class="btn btn-coral" onclick="openModal()">View Full Size</button>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-brand">
                <span>ü¶å</span>
                MoosePack Home
            </div>
            <div>Know Your Homebook - Page Preview for Kindle</div>
        </footer>
    </div>

    <!-- Modal -->
    <div class="modal-backdrop" id="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&#10005;</button>
            <button class="modal-nav modal-prev" id="modalPrev" onclick="navigatePage(-1)">&#8592;</button>
            <button class="modal-nav modal-next" id="modalNext" onclick="navigatePage(1)">&#8594;</button>
            <div class="modal-frame-wrapper">
                <iframe class="modal-frame" id="modalFrame" src="about:blank"></iframe>
            </div>
            <div class="modal-page-info" id="modalPageInfo">Page 1 of 40</div>
        </div>
    </div>

    <script>
        // Page Data - All 40 pages organized by section
        const sections = [
            {
                id: 1,
                name: "Welcome",
                icon: "üëã",
                pages: [
                    { num: 1, title: "Cover Page", file: "pages/01-cover.html" },
                    { num: 2, title: "Home Snapshot", file: "pages/02-home-snapshot.html" }
                ]
            },
            {
                id: 2,
                name: "Exterior",
                icon: "üèóÔ∏è",
                pages: [
                    { num: 3, title: "Roof Details", file: "samples/roof-details.html" },
                    { num: 4, title: "Siding & Exterior", file: "pages/04-siding-exterior.html" },
                    { num: 5, title: "Driveway & Walkways", file: "pages/05-driveway-walkways.html" },
                    { num: 6, title: "Gutters & Drainage", file: "pages/06-gutters-drainage.html" }
                ]
            },
            {
                id: 3,
                name: "Major Systems",
                icon: "‚öôÔ∏è",
                pages: [
                    { num: 7, title: "Water Heater", file: "pages/07-water-heater.html" },
                    { num: 8, title: "Furnace & Heating", file: "pages/08-furnace-heating.html" },
                    { num: 9, title: "Air Conditioning", file: "pages/09-air-conditioning.html" },
                    { num: 10, title: "Electrical System", file: "pages/10-electrical-system.html" },
                    { num: 11, title: "GFCI Outlets", file: "pages/11-gfci-outlets.html" },
                    { num: 12, title: "Plumbing System", file: "pages/12-plumbing-system.html" },
                    { num: 13, title: "Basement & Sump", file: "pages/13-basement-sump.html" },
                    { num: 14, title: "Fireplaces & Chimneys", file: "pages/14-fireplaces-chimneys.html" },
                    { num: 15, title: "Septic & Sewer", file: "pages/15-septic-sewer.html" }
                ]
            },
            {
                id: 4,
                name: "Interior",
                icon: "üè†",
                pages: [
                    { num: 16, title: "Flooring Map", file: "pages/16-flooring-map.html" },
                    { num: 17, title: "Paint Colors", file: "pages/17-paint-colors.html" }
                ]
            },
            {
                id: 5,
                name: "Safety",
                icon: "üõ°Ô∏è",
                pages: [
                    { num: 18, title: "Smoke & CO Detectors", file: "pages/18-smoke-co-detectors.html" },
                    { num: 19, title: "Shutoffs & Utilities", file: "pages/19-shutoffs-utilities.html" },
                    { num: 20, title: "Emergency Contacts", file: "pages/20-emergency-contacts.html" },
                    { num: 21, title: "Emergency Protocols", file: "pages/21-emergency-protocols.html" }
                ]
            },
            {
                id: 6,
                name: "Maintenance",
                icon: "üìã",
                pages: [
                    { num: 22, title: "Why Maintenance Matters", file: "pages/22-why-maintenance-matters.html" },
                    { num: 23, title: "Maintenance Checklist", file: "samples/maintenance.html" },
                    { num: 24, title: "Maintenance Log", file: "pages/24-maintenance-log.html" }
                ]
            },
            {
                id: 7,
                name: "Trades",
                icon: "üîß",
                pages: [
                    { num: 25, title: "Core Trades", file: "pages/25-core-trades.html" },
                    { num: 26, title: "Preferred Providers", file: "pages/26-preferred-providers.html" },
                    { num: 27, title: "Insurance Info", file: "pages/27-insurance-info.html" }
                ]
            },
            {
                id: 8,
                name: "What To Do If...",
                icon: "‚ùì",
                pages: [
                    { num: 28, title: "Water Spot on Ceiling", file: "samples/water-spot.html" },
                    { num: 29, title: "Power Goes Out", file: "pages/29-power-goes-out.html" },
                    { num: 30, title: "HVAC Stops Working", file: "pages/30-hvac-stops-working.html" },
                    { num: 31, title: "Water Heater Leaks", file: "pages/31-water-heater-leaks.html" },
                    { num: 32, title: "Toilet Overflows", file: "pages/32-toilet-overflows.html" },
                    { num: 33, title: "Pipe Bursts", file: "pages/33-pipe-bursts.html" },
                    { num: 34, title: "Garage Door Won't Open", file: "pages/34-garage-door-wont-open.html" },
                    { num: 35, title: "Smoke Detector Beeping", file: "pages/35-smoke-detector-beeping.html" },
                    { num: 36, title: "Smell Gas", file: "pages/36-smell-gas.html" },
                    { num: 37, title: "Foundation Crack", file: "pages/37-foundation-crack.html" }
                ]
            },
            {
                id: 9,
                name: "Records",
                icon: "üìÅ",
                pages: [
                    { num: 38, title: "Purchase Records", file: "pages/38-purchase-records.html" },
                    { num: 39, title: "Appliance Records", file: "pages/39-appliance-records.html" },
                    { num: 40, title: "Warranty Tracker", file: "pages/40-warranty-tracker.html" }
                ]
            }
        ];

        // Flatten pages for navigation
        const allPages = sections.flatMap(s => s.pages);
        let currentPageIndex = 0;
        let activeSection = null;

        // Initialize TOC
        function initTOC() {
            const toc = document.getElementById('toc');
            toc.innerHTML = sections.map(section => `
                <div class="section" data-section="${section.id}">
                    <div class="section-header" onclick="toggleSection(${section.id})">
                        <div class="section-info">
                            <span class="section-icon">${section.icon}</span>
                            <span class="section-name">${section.name}</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span class="section-badge">${section.pages.length}</span>
                            <span class="section-chevron">‚ñº</span>
                        </div>
                    </div>
                    <div class="section-pages">
                        ${section.pages.map(page => `
                            <div class="page-item" data-page="${page.num}" onclick="selectPage(${page.num})">
                                <span class="page-num">${page.num}</span>
                                <span>${page.title}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');

            // Open first section by default
            toggleSection(1);
            selectPage(1);
        }

        // Toggle section accordion
        function toggleSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(s => {
                if (parseInt(s.dataset.section) === sectionId) {
                    s.classList.toggle('active');
                } else {
                    s.classList.remove('active');
                }
            });
        }

        // Select a page
        function selectPage(pageNum) {
            currentPageIndex = allPages.findIndex(p => p.num === pageNum);
            const page = allPages[currentPageIndex];

            // Update active states
            document.querySelectorAll('.page-item').forEach(item => {
                item.classList.toggle('active', parseInt(item.dataset.page) === pageNum);
            });

            // Expand parent section
            const sectionId = sections.find(s => s.pages.some(p => p.num === pageNum)).id;
            document.querySelectorAll('.section').forEach(s => {
                s.classList.toggle('active', parseInt(s.dataset.section) === sectionId);
            });

            // Update preview
            loadPage(page);
        }

        // Load page into preview
        function loadPage(page) {
            const previewFrame = document.getElementById('previewFrame');
            const modalFrame = document.getElementById('modalFrame');
            const loading = document.getElementById('previewLoading');

            loading.classList.remove('hidden');
            previewFrame.src = page.file;
            modalFrame.src = page.file;

            previewFrame.onload = () => {
                loading.classList.add('hidden');
            };

            // Update UI
            document.getElementById('previewTitle').textContent = page.title;
            document.getElementById('pageCounter').textContent = `${page.num} / 40`;
            document.getElementById('modalPageInfo').textContent = `Page ${page.num} of 40 - ${page.title}`;

            // Update nav buttons
            document.getElementById('prevBtn').disabled = currentPageIndex === 0;
            document.getElementById('nextBtn').disabled = currentPageIndex === allPages.length - 1;
            document.getElementById('modalPrev').disabled = currentPageIndex === 0;
            document.getElementById('modalNext').disabled = currentPageIndex === allPages.length - 1;
        }

        // Navigate pages
        function navigatePage(direction) {
            const newIndex = currentPageIndex + direction;
            if (newIndex >= 0 && newIndex < allPages.length) {
                selectPage(allPages[newIndex].num);
            }
        }

        // Modal functions
        function openModal() {
            document.getElementById('modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            const modal = document.getElementById('modal');
            const isModalOpen = modal.classList.contains('active');

            if (e.key === 'Escape' && isModalOpen) {
                closeModal();
            } else if (e.key === 'ArrowLeft') {
                navigatePage(-1);
            } else if (e.key === 'ArrowRight') {
                navigatePage(1);
            }
        });

        // Close modal on backdrop click
        document.getElementById('modal').addEventListener('click', (e) => {
            if (e.target.id === 'modal') {
                closeModal();
            }
        });

        // Initialize
        initTOC();
    </script>
</body>
</html>
